#!/usr/bin/env php
<?php
chdir('lib');
$phar = new Phar('proem.phar');
$phar->buildFromDirectory('.');
$phar->setStub("<?php
Phar::mapPhar('proem.phar');
require_once 'phar://proem.phar/Proem/Autoloader.php';
(new Proem\Autoloader())->registerNamespaces(['Proem' => 'phar://proem.phar'])->register();
__HALT_COMPILER();
?>");
$phar->convertToExecutable(Phar::TAR, Phar::GZ);
rename('proem.phar', '../build/proem.phar');
rename('proem.phar.tar.gz', '../build/proem.phar.tar.gz');
